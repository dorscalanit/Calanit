<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate-key="home_page_title">×›×œ× ×™×ª | ×”×‘×™×ª ×©×œ×š ×œ×§×¨×™×™×¨×”</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Heebo', sans-serif; scroll-behavior: smooth; background-color: #f8fafc; color: #2d3748; }
        .brand-logo { font-weight: 900; font-size: 1.8rem; }
        .hero-gradient { background-color: #115e59; background-image: linear-gradient(135deg, #14b8a6 0%, #0f766e 100%); }
        .cta-gradient { background-color: #f0fdfa; }
        .story-slider-container .swiper { height: 480px; border-radius: 1.5rem; box-shadow: 0 10px 25px -5px rgba(0,0,0,0.07); position: relative; overflow: hidden; }
        .story-slider-container .swiper-slide { color: white; display: flex; flex-direction: column; justify-content: flex-end; padding: 2rem; background-size: cover; background-position: center; }
        .story-slider-container .story-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(0,0,0,0.75) 0%, rgba(0,0,0,0.3) 40%, rgba(0,0,0,0) 100%); }
        .story-slider-container .story-content { position: relative; z-index: 10; }
        .story-slider-container .swiper-pagination-progressbar { top: 0 !important; bottom: auto !important; height: 4px !important; background: rgba(255,255,255,0.3) !important; }
        .story-slider-container .swiper-pagination-progressbar-fill { background: #fff !important; }
        .story-slider-container .swiper-button-next, .story-slider-container .swiper-button-prev { color: white; background-color: rgba(0,0,0,0.25); width: 44px; height: 44px; border-radius: 50%; transition: background-color 0.2s ease; }
        .story-slider-container .swiper-button-next:hover, .story-slider-container .swiper-button-prev:hover { background-color: rgba(0,0,0,0.5); }
        .story-slider-container .swiper-button-next::after, .story-slider-container .swiper-button-prev::after { font-size: 18px; }
        .animated-section { opacity: 0; transform: translateY(40px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .animated-section.is-visible { opacity: 1; transform: translateY(0); }
        .autocomplete-item:hover { background-color: #f0fdfa; }
        select:disabled { background-color: #e5e7eb; cursor: not-allowed; }
        .bubble-location { background-color: #cffafe; color: #155e75; }
        .bubble-category { background-color: #d1fae5; color: #065f46; }
        .lang-btn-menu.active { background-color: #14b8a6; color: white; }
        .modal { transition: opacity 0.3s ease; }
        .modal-content { transition: transform 0.3s ease, opacity 0.3s ease; }
        .modal.opacity-0 { pointer-events: none; }
  
    .partners-section { background: #fff; border-top: 2px solid #e0f2fe; padding: 56px 0 48px 0; }
.partners-title { font-size: 2rem; font-weight: 700; color: #155e75; text-align: center; margin-bottom: 2rem; letter-spacing: 0.03em;}
.partners-marquee-container { overflow: hidden; width: 100%; position: relative; height: 110px;}
.partners-marquee-track {
    display: flex; align-items: center; gap: 64px;
    will-change: transform;
    animation: marquee-rtl 24s linear infinite;
}
.partners-marquee-track:hover { animation-play-state: paused; }
.partner-logo-wrapper { flex: 0 0 auto; display: flex; align-items: center; justify-content: center; }
.partner-logo-img { height: 72px; width: auto; object-fit: contain; filter: grayscale(0.2); transition: filter .2s;}
.partner-logo-img:hover { filter: grayscale(0) drop-shadow(0 2px 12px #cffafe60);}
@keyframes marquee-rtl {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
}
@media (max-width: 640px) {
    .partners-title { font-size: 1.25rem;}
    .partners-marquee-track { gap: 32px;}
    .partners-marquee-container { height: 75px;}
    .partner-logo-img { height: 44px;}
}
    
      </style>
</head>
<body class="text-gray-800">
    <header id="header-placeholder"></header>

    <main>
        <section class="hero-gradient text-white">
            <div class="container mx-auto px-6 pt-20 pb-24 text-center">
                <h1 class="text-4xl md:text-6xl font-black mb-4 drop-shadow-md" data-translate-key="hero_title">×”×¦×¢×“ ×”×‘× ×‘×§×¨×™×™×¨×” ×©×œ×š ××ª×—×™×œ ×›××Ÿ</h1>
                <p class="text-lg md:text-xl mb-12 max-w-3xl mx-auto opacity-90" data-translate-key="hero_subtitle">××©×¨×•×ª ×—×“×©×•×ª ××”×—×‘×¨×•×ª ×”××•×‘×™×œ×•×ª ×‘××©×§, ××—×›×•×ª ×¨×§ ×œ×š.</p>
                <div class="max-w-5xl mx-auto bg-white/10 backdrop-blur-sm p-4 rounded-2xl shadow-2xl">
                    <div id="search-form" class="grid grid-cols-1 md:grid-cols-4 gap-4 items-start">
                        <input type="text" id="keyword-search-input" data-translate-key="placeholder_keyword" placeholder="×œ×“×•×’××: ××¤×ª×— Full-Stack..." class="md:col-span-4 w-full px-4 py-3 rounded-lg text-gray-800 focus:outline-none focus:ring-4 focus:ring-teal-300" />
                        <div class="relative md:col-span-2">
                            <input type="text" id="location-search-input" data-translate-key="placeholder_location" placeholder="×”×§×œ×“/×™ ×¢×™×¨..." autocomplete="off" class="w-full px-4 py-3 rounded-lg text-gray-800 focus:outline-none focus:ring-4 focus:ring-teal-300">
                            <div id="autocomplete-results" class="absolute top-full left-0 right-0 bg-white border rounded-b-lg shadow-lg z-20 hidden max-h-60 overflow-y-auto text-right"></div>
                        </div>
                        <div class="relative">
                            <select id="main-category-select" class="w-full px-4 py-3 rounded-lg text-gray-500 focus:outline-none focus:ring-4 focus:ring-teal-300">
                                <option value="" data-translate-key="select_main_category">×‘×—×¨/×™ ×ª×—×•× ×¨××©×™</option>
                            </select>
                        </div>
                        <div class="relative">
                            <select id="subcategory-select" disabled class="w-full px-4 py-3 rounded-lg text-gray-500 focus:outline-none focus:ring-4 focus:ring-teal-300">
                                <option value="" data-translate-key="select_subcategory">×‘×—×¨/×™ ×ª×ª ×§×˜×’×•×¨×™×”</option>
                            </select>
                        </div>
                        <div class="md:col-span-4 flex flex-col md:flex-row gap-4 mt-2 px-2 min-h-[40px]">
                            <div id="selected-locations-container" class="flex flex-wrap gap-2 items-center justify-center md:justify-start flex-grow"></div>
                            <div id="selected-categories-container" class="flex flex-wrap gap-2 items-center justify-center md:justify-start flex-grow"></div>
                        </div>
                        <button id="search-button" class="md:col-span-4 w-full bg-white text-teal-600 font-bold px-8 py-3 rounded-lg hover:bg-teal-50 transition duration-300 text-lg shadow-md hover:shadow-lg">
                            <i class="fas fa-search"></i>
                            <span class="ml-2" data-translate-key="search_jobs_button">×—×™×¤×•×© ××©×¨×•×ª</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-24 bg-white animated-section">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold mb-3" data-translate-key="category_section_title">×—×™×¤×•×© ×œ×¤×™ ×ª×—×•×</h2>
                    <p class="text-lg text-gray-600" data-translate-key="category_section_subtitle">××¦×/×™ ××ª ×”××©×¨×” ×”×‘××” ×©×œ×š ×‘×§×œ×•×ª.</p>
                </div>
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-6 text-center">
                    <a href="jobs.html?categories=×‘×™×˜×—×•×Ÿ" class="group block bg-white p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-2 transition-all duration-300">
                        <div class="flex items-center justify-center h-20 w-20 mx-auto rounded-full bg-blue-100 text-blue-600">
                            <i class="fas fa-shield-halved text-4xl"></i>
                        </div>
                        <h3 class="font-bold mt-4 text-lg text-gray-800" data-translate-key="cat_security">×‘×™×˜×—×•×Ÿ</h3>
                    </a>
                    <a href="jobs.html?categories=× ×”×’×™×" class="group block bg-white p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-2 transition-all duration-300">
                        <div class="flex items-center justify-center h-20 w-20 mx-auto rounded-full bg-orange-100 text-orange-600">
                            <i class="fas fa-car text-4xl"></i>
                        </div>
                        <h3 class="font-bold mt-4 text-lg text-gray-800" data-translate-key="cat_drivers">× ×”×’×™×</h3>
                    </a>
                    <a href="jobs.html?categories=×™×¦×•×¨ ×•×ª×¢×©×™×™×”" class="group block bg-white p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-2 transition-all duration-300">
                        <div class="flex items-center justify-center h-20 w-20 mx-auto rounded-full bg-gray-200 text-gray-700">
                            <i class="fas fa-industry text-4xl"></i>
                        </div>
                        <h3 class="font-bold mt-4 text-lg text-gray-800" data-translate-key="cat_manufacturing">×™×¦×•×¨ ×•×ª×¢×©×™×™×”</h3>
                    </a>
                    <a href="jobs.html?categories=× ×™×§×™×•×Ÿ" class="group block bg-white p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-2 transition-all duration-300">
                        <div class="flex items-center justify-center h-20 w-20 mx-auto rounded-full bg-green-100 text-green-600">
                            <i class="fas fa-broom text-4xl"></i>
                        </div>
                        <h3 class="font-bold mt-4 text-lg text-gray-800" data-translate-key="cat_cleaning">× ×™×§×™×•×Ÿ</h3>
                    </a>
                    <a href="jobs.html?categories=××—×¡× ×™×" class="group block bg-white p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-2 transition-all duration-300">
                        <div class="flex items-center justify-center h-20 w-20 mx-auto rounded-full bg-purple-100 text-purple-600">
                            <i class="fas fa-warehouse text-4xl"></i>
                        </div>
                        <h3 class="font-bold mt-4 text-lg text-gray-800" data-translate-key="cat_warehouse">××—×¡× ×™×</h3>
                    </a>
                    <a href="javascript:void(0);" onclick="window.openCVModal()" class="group block bg-white p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-2 transition-all duration-300">
                        <div class="flex items-center justify-center h-20 w-20 mx-auto rounded-full bg-teal-100 text-teal-600">
                           <i class="fas fa-paper-plane text-4xl"></i>
                        </div>
                        <h3 class="font-bold mt-4 text-lg text-gray-800" data-translate-key="cat_no_experience">×œ×œ× × ×™×¡×™×•×Ÿ</h3>
                    </a>
                </div>
            </div>
        </section>
        <section class="py-24 animated-section">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold mb-3" data-translate-key="hot_jobs_title">××©×¨×•×ª ×—××•×ª ğŸ”¥</h2>
                    <p class="text-lg text-gray-600" data-translate-key="hot_jobs_subtitle">×”×–×“×× ×•×™×•×ª ×©××¡×•×¨ ×œ×›× ×œ×¤×¡×¤×¡.</p>
                </div>
                <div class="relative story-slider-container" id="hot-jobs-container">
                    <div class="swiper hot-jobs-slider">
                        <div class="swiper-wrapper"></div>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination swiper-pagination-progressbar swiper-pagination-horizontal"></div>
                    </div>
                </div>
            </div>
        </section>
        <section class="py-24 bg-white animated-section">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold mb-3" data-translate-key="new_jobs_title">××©×¨×•×ª ×—×“×©×•×ª âœ¨</h2>
                    <p class="text-lg text-gray-600" data-translate-key="new_jobs_subtitle">×”×”×–×“×× ×•×™×•×ª ×”××—×¨×•× ×•×ª ×©×”×¦×˜×¨×¤×•.</p>
                </div>
                <div class="relative story-slider-container" id="new-jobs-container">
                    <div class="swiper new-jobs-slider">
                        <div class="swiper-wrapper"></div>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination swiper-pagination-progressbar swiper-pagination-horizontal"></div>
                    </div>
                </div>
            </div>
        </section>
        <section id="send-cv-section" class="py-24 cta-gradient animated-section">
            <div class="container mx-auto px-6 text-center">
                <div class="max-w-3xl mx-auto">
                    <i class="fas fa-file-signature text-6xl text-teal-500 mb-6"></i>
                    <h2 class="text-3xl md:text-4xl font-bold mb-4" data-translate-key="cta_title">×œ× ××¦××ª× ××ª ××” ×©×—×™×¤×©×ª×?</h2>
                    <p class="text-lg text-gray-600 mb-8" data-translate-key="cta_subtitle">×©×œ×—×• ×œ× ×• ××ª ×§×•×¨×•×ª ×”×—×™×™× ×•×”×¦×•×•×ª ×”××§×¦×•×¢×™ ×©×œ× ×• ×™××¦× ×¢×‘×•×¨×›× ××ª ×”×”×–×“×× ×•×ª ×”×‘××”.</p>
                    <button id="open-cv-modal-button" class="bg-teal-500 text-white font-bold px-10 py-4 rounded-full hover:bg-teal-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 text-xl">
                        <i class="fas fa-paper-plane mr-3"></i>
                        <span data-translate-key="cta_button">×©×œ×™×—×ª ×§×•×¨×•×ª ×—×™×™×</span>
                    </button>
                </div>
            </div>
        </section>

        <section class="py-24 bg-white animated-section">
            <div class="container mx-auto px-6 text-center">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold mb-3" data-translate-key="social_title">×‘×•××• × ×›×™×¨</h2>
                    <p class="text-lg text-gray-600 mb-10" data-translate-key="social_subtitle">×× ×—× ×• ×œ× ×¨×§ ××—×¤×©×™× ×œ×›× ×¢×‘×•×“×”, ×× ×—× ×• ×‘×•× ×™× ×™×—×“ ××™×ª×›× ××ª ×”×§×¨×™×™×¨×” ×©×œ×›×. ×¢×§×‘×• ××—×¨×™× ×• ×‘×¨×©×ª×•×ª ×”×—×‘×¨×ª×™×•×ª ×›×“×™ ×œ×§×‘×œ ×˜×™×¤×™×, ×¢×“×›×•× ×™× ×¢×œ ××©×¨×•×ª ×—××•×ª ×•×”×¦×¦×” ×œ×—×™×™× ×‘××©×¨×“.</p>
                    <div class="flex flex-col md:flex-row justify-center gap-6">
                        <a href="https://www.facebook.com/profile.php?id=61577628773715&mibextid=rS40aB7S9Ucbxw6v" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center gap-4 bg-blue-600 text-white font-bold px-8 py-4 rounded-lg hover:bg-blue-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 text-xl w-full md:w-auto">
                            <i class="fab fa-facebook text-2xl"></i>
                            <span data-translate-key="social_follow_facebook">×¢×§×‘×• ××—×¨×™× ×• ×‘×¤×™×™×¡×‘×•×§</span>
                        </a>
                        <a href="https://www.tiktok.com/@calanit_hr?_t=ZS-8xDrw4nwyck&_r=1" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center gap-4 bg-gray-800 text-white font-bold px-8 py-4 rounded-lg hover:bg-gray-900 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 text-xl w-full md:w-auto">
                            <i class="fab fa-tiktok text-2xl"></i>
                            <span data-translate-key="social_follow_tiktok">×¢×§×‘×• ××—×¨×™× ×• ×‘×˜×™×§×˜×•×§</span>
                        </a>
                        <a href="https://www.instagram.com/calanit_hr?igsh=eXQ0ZWVqZjUydXVu&utm_source=qr" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center gap-4 bg-pink-600 text-white font-bold px-8 py-4 rounded-lg hover:bg-pink-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 text-xl w-full md:w-auto">
                            <i class="fab fa-instagram text-2xl"></i>
                            <span data-translate-key="social_follow_instagram">×¢×§×‘×• ××—×¨×™× ×• ×‘××™× ×¡×˜×’×¨×</span>
                        </a>
                    </div>
                </div>
            </div>
        </section>
        </main>
    
    <div id="cv-modal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-white w-full max-w-lg rounded-2xl shadow-2xl p-6 md:p-8 transform scale-95 opacity-0 relative">
            <button id="close-cv-modal" class="absolute top-4 left-4 text-gray-400 hover:text-gray-700 text-2xl w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-all">&times;</button>
            <h3 id="cv-modal-title" class="text-2xl font-bold mb-6 text-center text-gray-800" data-translate-key="cv_modal_title">×©×œ×™×—×ª ×§×•×¨×•×ª ×—×™×™×</h3>
            <form id="cv-form" class="space-y-5">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div>
                        <label for="firstName" class="font-medium text-sm text-gray-700" data-translate-key="form_first_name">×©× ×¤×¨×˜×™ <span class="text-red-500">*</span></label>
                        <input type="text" id="firstName" required class="mt-1 w-full border-gray-300 rounded-lg shadow-sm px-4 py-2 focus:ring-teal-500 focus:border-teal-500 transition">
                    </div>
                    <div>
                        <label for="lastName" class="font-medium text-sm text-gray-700" data-translate-key="form_last_name">×©× ××©×¤×—×” <span class="text-red-500">*</span></label>
                        <input type="text" id="lastName" required class="mt-1 w-full border-gray-300 rounded-lg shadow-sm px-4 py-2 focus:ring-teal-500 focus:border-teal-500 transition">
                    </div>
                </div>
                <div>
                    <label for="phone" class="font-medium text-sm text-gray-700" data-translate-key="form_phone">×˜×œ×¤×•×Ÿ <span class="text-red-500">*</span></label>
                    <input type="tel" id="phone" required pattern="^05\d{8}$" placeholder="05XXXXXXXX" class="mt-1 w-full border-gray-300 rounded-lg shadow-sm px-4 py-2 focus:ring-teal-500 focus:border-teal-500 transition">
                </div>
                <div>
                    <label for="cvFile" class="font-medium text-sm block text-gray-700" data-translate-key="form_cv_file">×§×•×‘×¥ ×§×•×¨×•×ª ×—×™×™× <span class="text-red-500">*</span></label>
                    <input type="file" id="cvFile" required accept=".pdf,.doc,.docx" class="mt-2 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100 transition">
                    <p class="text-xs text-gray-500 mt-1" data-translate-key="form_supported_files">×§×‘×¦×™× × ×ª××›×™×: PDF, DOC, DOCX</p>
                </div>
                <button type="submit" id="cv-submit-button" class="w-full bg-teal-500 text-white py-3 rounded-lg font-bold text-lg hover:bg-teal-600 transition-all duration-300 shadow-md hover:shadow-lg flex items-center justify-center gap-3">
                    <span data-translate-key="cta_button">×©×œ×™×—×ª ×§×•×¨×•×ª ×—×™×™×</span>
                </button>
                <div id="cv-form-message" class="text-center text-sm font-medium mt-3 h-5"></div>
            </form>
        </div>
    </div>

<!-- ××–×•×¨ ×¢×•×‘×¨×™× ××™×ª× ×• -->
<section class="partners-section">
    <div class="container mx-auto px-6">
        <h2 class="partners-title">×¢×•×‘×“×™× ××™×ª× ×•</h2>
        <div class="partners-marquee-container">
            <div id="partners-marquee-track" class="partners-marquee-track"></div>
        </div>
    </div>
</section>

    <footer id="footer-placeholder"></footer>
    
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, query, where, getDocs, orderBy, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";
        
        const firebaseConfig = { apiKey: "AIzaSyAOKMJabnJ9JGE5CuclCCSjv5Bo3rT49Cw", authDomain: "calanit-31a32.firebaseapp.com", projectId: "calanit-31a32", storageBucket: "calanit-31a32.firebasestorage.app", messagingSenderId: "91430351613", appId: "1:91430351613:web:ae46b2063f2d4b71428494" };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);

        const translations = {
            he: { home_page_title: "×›×œ× ×™×ª | ×”×‘×™×ª ×©×œ×š ×œ×§×¨×™×™×¨×”", hero_title: "×”×¦×¢×“ ×”×‘× ×‘×§×¨×™×™×¨×” ×©×œ×š ××ª×—×™×œ ×›××Ÿ", hero_subtitle: "××©×¨×•×ª ×—×“×©×•×ª ××”×—×‘×¨×•×ª ×”××•×‘×™×œ×•×ª ×‘××©×§, ××—×›×•×ª ×¨×§ ×œ×š.", placeholder_keyword: "×œ×“×•×’××: ××¤×ª×— Full-Stack...", placeholder_location: "×”×§×œ×“/×™ ×¢×™×¨...", select_main_category: "×‘×—×¨/×™ ×ª×—×•× ×¨××©×™", select_subcategory: "×‘×—×¨/×™ ×ª×ª ×§×˜×’×•×¨×™×”", search_jobs_button: "×—×™×¤×•×© ××©×¨×•×ª", category_section_title: "×—×™×¤×•×© ×œ×¤×™ ×ª×—×•×", category_section_subtitle: "××¦×/×™ ××ª ×”××©×¨×” ×”×‘××” ×©×œ×š ×‘×§×œ×•×ª.", cat_security: "×‘×™×˜×—×•×Ÿ", cat_drivers: "× ×”×’×™×", cat_manufacturing: "×™×¦×•×¨ ×•×ª×¢×©×™×™×”", cat_cleaning: "× ×™×§×™×•×Ÿ", cat_warehouse: "××—×¡× ×™×", cat_no_experience: "×œ×œ× × ×™×¡×™×•×Ÿ", hot_jobs_title: "××©×¨×•×ª ×—××•×ª ğŸ”¥", hot_jobs_subtitle: "×”×–×“×× ×•×™×•×ª ×©××¡×•×¨ ×œ×›× ×œ×¤×¡×¤×¡.", new_jobs_title: "××©×¨×•×ª ×—×“×©×•×ª âœ¨", new_jobs_subtitle: "×”×”×–×“×× ×•×™×•×ª ×”××—×¨×•× ×•×ª ×©×”×¦×˜×¨×¤×•.", cta_title: "×œ× ××¦××ª× ××ª ××” ×©×—×™×¤×©×ª×?", cta_subtitle: "×©×œ×—×• ×œ× ×• ××ª ×§×•×¨×•×ª ×”×—×™×™× ×•×”×¦×•×•×ª ×”××§×¦×•×¢×™ ×©×œ× ×• ×™××¦× ×¢×‘×•×¨×›× ××ª ×”×”×–×“×× ×•×ª ×”×‘××”.", cta_button: "×©×œ×™×—×ª ×§×•×¨×•×ª ×—×™×™×", no_hot_jobs: "××™×Ÿ ×›×¨×’×¢ ××©×¨×•×ª ×—××•×ª", no_new_jobs: "××™×Ÿ ××©×¨×•×ª ××”×©×‘×•×¢ ×”××—×¨×•×Ÿ", details_button: "×¤×¨×˜×™× × ×•×¡×¤×™×", cv_modal_title: "×©×œ×™×—×ª ×§×•×¨×•×ª ×—×™×™×", form_first_name: "×©× ×¤×¨×˜×™", form_last_name: "×©× ××©×¤×—×”", form_phone: "×˜×œ×¤×•×Ÿ", form_cv_file: "×§×•×‘×¥ ×§×•×¨×•×ª ×—×™×™×", form_supported_files: "×§×‘×¦×™× × ×ª××›×™×: PDF, DOC, DOCX", success_message: "×”×¤×¨×˜×™× × ×©×œ×—×• ×‘×”×¦×œ×—×”!", error_message: "××™×¨×¢×” ×©×’×™××” ×‘×©×œ×™×—×”.", sending_message: "×©×•×œ×—...", nav_home: "×“×£ ×”×‘×™×ª", nav_all_jobs: "×›×œ ×”××©×¨×•×ª", nav_send_cv: "×©×œ×™×—×ª ×§×•\"×—", nav_contact: "×™×¦×™×¨×ª ×§×©×¨", nav_publish_job: "×¤×¨×¡×•× ×“×¨×™×©×”", nav_publish_job_mobile: "×¤×¨×¡×•× ×“×¨×™×©×ª ×¢×•×‘×“×™×", social_title: "×‘×•××• × ×›×™×¨", social_subtitle: "×× ×—× ×• ×œ× ×¨×§ ××—×¤×©×™× ×œ×›× ×¢×‘×•×“×”, ×× ×—× ×• ×‘×•× ×™× ×™×—×“ ××™×ª×›× ××ª ×”×§×¨×™×™×¨×” ×©×œ×›×. ×¢×§×‘×• ××—×¨×™× ×• ×‘×¨×©×ª×•×ª ×”×—×‘×¨×ª×™×•×ª ×›×“×™ ×œ×§×‘×œ ×˜×™×¤×™×, ×¢×“×›×•× ×™× ×¢×œ ××©×¨×•×ª ×—××•×ª ×•×”×¦×¦×” ×œ×—×™×™× ×‘××©×¨×“.", social_follow_facebook: "×¢×§×‘×• ××—×¨×™× ×• ×‘×¤×™×™×¡×‘×•×§", social_follow_tiktok: "×¢×§×‘×• ××—×¨×™× ×• ×‘×˜×™×§×˜×•×§", social_follow_instagram: "×¢×§×‘×• ××—×¨×™× ×• ×‘××™× ×¡×˜×’×¨×", footer_about: "××—×‘×¨×™× ×‘×™×Ÿ ×× ×©×™× ×œ×”×–×“×× ×•×™×•×ª.", footer_nav_quick: "× ×™×•×•×˜ ××”×™×¨", footer_nav_all_jobs: "×›×œ ×”××©×¨×•×ª", footer_nav_send_cv: "×©×œ×™×—×ª ×§×•×¨×•×ª ×—×™×™×", footer_nav_publish_job: "×¤×¨×¡×•× ×“×¨×™×©×”", footer_nav_contact: "×¦×•×¨ ×§×©×¨", footer_nav_legal: "××™×“×¢ ×•××©×¤×˜×™", footer_nav_privacy: "××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª", footer_nav_terms: "×ª× ××™ ×©×™××•×©", footer_nav_talk: "×“×‘×¨×• ××™×ª× ×•", footer_copyright: "&copy; ×›×œ ×”×–×›×™×•×ª ×©××•×¨×•×ª ×“×•×¨×•×Ÿ AI ××ª×¨×™× 2025     " },
            ar: { home_page_title: "ÙƒÙ„Ø§Ù†ÙŠØª | Ø¨ÙŠØªÙƒ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ù…Ù‡Ù†ÙŠ", hero_title: "Ø®Ø·ÙˆØªÙƒ Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙŠ Ø­ÙŠØ§ØªÙƒ Ø§Ù„Ù…Ù‡Ù†ÙŠØ© ØªØ¨Ø¯Ø£ Ù‡Ù†Ø§", hero_subtitle: "ÙˆØ¸Ø§Ø¦Ù Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø±Ø§Ø¦Ø¯Ø© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ØŒ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø±Ùƒ.", placeholder_keyword: "Ù…Ø«Ø§Ù„: Ù…Ø·ÙˆØ± Full-Stack...", placeholder_location: "Ø£Ø¯Ø®Ù„ Ù…Ø¯ÙŠÙ†Ø©...", select_main_category: "Ø§Ø®ØªØ± Ù…Ø¬Ø§Ù„ Ø±Ø¦ÙŠØ³ÙŠ", select_subcategory: "Ø§Ø®ØªØ± ØªØ®ØµØµ ÙØ±Ø¹ÙŠ", search_jobs_button: "Ø¨Ø­Ø« Ø¹Ù† ÙˆØ¸Ø§Ø¦Ù", category_section_title: "Ø§Ù„Ø¨Ø­Ø« Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù„", category_section_subtitle: "Ø§Ø¨Ø­Ø« Ø¹Ù† ÙˆØ¸ÙŠÙØªÙƒ Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø³Ù‡ÙˆÙ„Ø©.", cat_security: "Ø£Ù…Ù†", cat_drivers: "Ø³Ø§Ø¦Ù‚ÙˆÙ†", cat_manufacturing: "ØªØµÙ†ÙŠØ¹ ÙˆØµÙ†Ø§Ø¹Ø©", cat_cleaning: "ØªÙ†Ø¸ÙŠÙ", cat_warehouse: "Ù…Ø®Ø§Ø²Ù†", cat_no_experience: "Ø¨Ø¯ÙˆÙ† Ø®Ø¨Ø±Ø©", hot_jobs_title: "ÙˆØ¸Ø§Ø¦Ù Ø³Ø§Ø®Ù†Ø© ğŸ”¥", hot_jobs_subtitle: "ÙØ±Øµ Ù„Ø§ ØªÙÙˆØª.", new_jobs_title: "ÙˆØ¸Ø§Ø¦Ù Ø¬Ø¯ÙŠØ¯Ø© âœ¨", new_jobs_subtitle: "Ø¢Ø®Ø± Ø§Ù„ÙØ±Øµ Ø§Ù„ØªÙŠ Ø§Ù†Ø¶Ù…Øª.", cta_title: "Ù„Ù… ØªØ¬Ø¯ Ù…Ø§ ÙƒÙ†Øª ØªØ¨Ø­Ø« Ø¹Ù†Ù‡ØŸ", cta_subtitle: "Ø£Ø±Ø³Ù„ Ù„Ù†Ø§ Ø³ÙŠØ±ØªÙƒ Ø§Ù„Ø°Ø§ØªÙŠØ© ÙˆØ³ÙŠØ¹Ø«Ø± ÙØ±ÙŠÙ‚Ù†Ø§ Ø§Ù„Ù…Ø­ØªØ±Ù Ø¹Ù„Ù‰ ÙØ±ØµØªÙƒ Ø§Ù„ØªØ§Ù„ÙŠØ©.", cta_button: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", no_hot_jobs: "Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ¸Ø§Ø¦Ù Ø³Ø§Ø®Ù†Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§", no_new_jobs: "Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ¸Ø§Ø¦Ù Ù…Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¶ÙŠ", details_button: "Ø§Ù„ØªÙØ§ØµÙŠÙ„", cv_modal_title: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", form_first_name: "Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„", form_last_name: "Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©", form_phone: "Ù‡Ø§ØªÙ", form_cv_file: "Ù…Ù„Ù Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", form_supported_files: "Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©: PDF, DOC, DOCX", success_message: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!", error_message: "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.", sending_message: "Ø¬Ø§Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...", nav_home: "Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", nav_all_jobs: "ÙƒÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù", nav_send_cv: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", nav_contact: "Ø§ØªØµÙ„ Ø¨Ù†Ø§", nav_publish_job: "Ù†Ø´Ø± Ø·Ù„Ø¨", nav_publish_job_mobile: "Ù†Ø´Ø± Ø·Ù„Ø¨ Ù…ÙˆØ¸ÙÙŠÙ†", social_title: "Ø¯Ø¹ÙˆÙ†Ø§ Ù†ØªØ¹Ø±Ù", social_subtitle: "Ù†Ø­Ù† Ù„Ø§ Ù†Ø¨Ø­Ø« Ù„Ùƒ Ø¹Ù† ÙˆØ¸ÙŠÙØ© ÙØ­Ø³Ø¨ØŒ Ø¨Ù„ Ù†Ø¨Ù†ÙŠ Ù…Ø¹Ùƒ Ù…Ø³ÙŠØ±ØªÙƒ Ø§Ù„Ù…Ù‡Ù†ÙŠØ©. ØªØ§Ø¨Ø¹Ù†Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†ØµØ§Ø¦Ø­ ÙˆØªØ­Ø¯ÙŠØ«Ø§Øª Ø­ÙˆÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø³Ø§Ø®Ù†Ø© ÙˆÙ†Ø¸Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙŠØ§Ø© ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨.", social_follow_facebook: "ØªØ§Ø¨Ø¹ÙˆÙ†Ø§ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ", social_follow_tiktok: "ØªØ§Ø¨Ø¹ÙˆÙ†Ø§ Ø¹Ù„Ù‰ ØªÙŠÙƒ ØªÙˆÙƒ", social_follow_instagram: "ØªØ§Ø¨Ø¹ÙˆÙ†Ø§ Ø¹Ù„Ù‰ Ø¥Ù†Ø³ØªØºØ±Ø§Ù…", footer_about: "Ù†Ø±Ø¨Ø· Ø§Ù„Ù†Ø§Ø³ Ø¨Ø§Ù„ÙØ±Øµ.", footer_nav_quick: "Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©", footer_nav_all_jobs: "ÙƒÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù", footer_nav_send_cv: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", footer_nav_publish_job: "Ù†Ø´Ø± Ø·Ù„Ø¨", footer_nav_contact: "Ø§ØªØµÙ„ Ø¨Ù†Ø§", footer_nav_legal: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆÙ‚Ø§Ù†ÙˆÙ†ÙŠØ©", footer_nav_privacy: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©", footer_nav_terms: "Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…", footer_nav_talk: "ØªØ­Ø¯Ø« Ù…Ø¹Ù†Ø§", footer_copyright: "&copy; 2024 ÙƒÙ„Ø§Ù†ÙŠØª. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©." }
        };

        function setLanguage(lang) {
            localStorage.setItem('calanit_lang', lang); document.documentElement.lang = lang;
            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.dataset.translateKey;
                if (translations[lang] && translations[lang][key]) { const value = translations[lang][key]; if (el.placeholder !== undefined) { el.placeholder = value; } else { el.innerHTML = value; } }
            });
            document.querySelectorAll('.lang-btn-menu').forEach(btn => { btn.classList.toggle('active', btn.id.includes(`-${lang}-`)); });
            createStorySlider({ containerId: '#hot-jobs-container', query: query(collection(db, "jobs"), where("isHot", "==", true)), noJobsKey: 'no_hot_jobs', jobIconClass: 'fas fa-fire text-amber-400' });
            createStorySlider({ containerId: '#new-jobs-container', query: query(collection(db, "jobs"), where("createdAt", ">=", new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)), orderBy("createdAt", "desc")), noJobsKey: 'no_new_jobs', jobIconClass: 'fas fa-sparkles text-sky-300' });
        }

        let allCities = [], jobTypesData = {}, selectedLocations = new Set(), selectedCategories = new Set();
        async function loadJsonData(filePath, fallback) { try { const res = await fetch(filePath); return res.ok ? res.json() : fallback; } catch (e) { return fallback; } }
        function loadComponent(url, id, cb) { fetch(url).then(res => res.ok ? res.text() : Promise.reject()).then(html => { document.getElementById(id).innerHTML = html; if (cb) cb(); }).catch(err => console.error(`Failed loading ${url}`)); }

        function setupFilterBubbles(config) {
            const { input, resultsContainer, bubblesContainer, dataSet, selectedSet } = config;
            input.addEventListener('input', () => {
                const query = input.value.trim();
                if (query.length < 2) { resultsContainer.classList.add('hidden'); return; }
                const filtered = dataSet.filter(c => c.startsWith(query) && !selectedSet.has(c)).slice(0, 7);
                resultsContainer.innerHTML = '';
                if(filtered.length) { filtered.forEach(itemText => { const item = document.createElement('div'); item.className = 'p-3 text-gray-800 cursor-pointer autocomplete-item'; item.textContent = itemText; item.addEventListener('click', () => addItem(itemText)); resultsContainer.appendChild(item); }); resultsContainer.classList.remove('hidden'); } else { resultsContainer.classList.add('hidden'); }
            });
            const addItem = (item) => { if (item && !selectedSet.has(item)) { selectedSet.add(item); renderBubbles(); } input.value = ''; resultsContainer.classList.add('hidden'); };
            const removeItem = (item) => { selectedSet.delete(item); renderBubbles(); };
            const renderBubbles = () => {
                bubblesContainer.innerHTML = '';
                const bubbleColorClass = config.colorClass || 'bubble-location';
                selectedSet.forEach(item => { const bubble = document.createElement('div'); bubble.className = `text-sm font-semibold px-3 py-1.5 rounded-full flex items-center gap-2 ${bubbleColorClass}`; bubble.innerHTML = `<span>${item}</span><button type="button" class="font-sans text-sm opacity-75 hover:opacity-100">&times;</button>`; bubble.querySelector('button').addEventListener('click', () => removeItem(item)); bubblesContainer.appendChild(bubble); });
            };
            document.addEventListener('click', e => { if (!input.contains(e.target)) resultsContainer.classList.add('hidden'); });
            bubblesContainer.addEventListener('render', renderBubbles);
        }

        function setupCategoryFilter() {
            const mainSelect = document.getElementById('main-category-select');
            const subSelect = document.getElementById('subcategory-select');
            const categoriesContainer = document.getElementById('selected-categories-container');
            const lang = localStorage.getItem('calanit_lang') || 'he';
            mainSelect.innerHTML = `<option value="">${translations[lang].select_main_category}</option>`;
            Object.keys(jobTypesData).sort().forEach(cat => mainSelect.add(new Option(cat, cat)));
            mainSelect.addEventListener('change', () => { const selectedMain = mainSelect.value; subSelect.innerHTML = `<option value="">${translations[lang].select_subcategory}</option>`; if (selectedMain && jobTypesData[selectedMain]) { jobTypesData[selectedMain].forEach(sub => subSelect.add(new Option(sub, sub))); subSelect.disabled = false; } else { subSelect.disabled = true; } });
            subSelect.addEventListener('change', () => { if (subSelect.value) { selectedCategories.add(subSelect.value); categoriesContainer.dispatchEvent(new Event('render')); subSelect.value = ""; } });
        }
        
        async function createStorySlider(config) {
            const swiperWrapper = document.querySelector(`${config.containerId} .swiper-wrapper`);
            if (!swiperWrapper) return;
            swiperWrapper.innerHTML = `<div class="swiper-slide bg-gray-200"><div class="story-content text-center text-gray-600"><i class="fas fa-spinner fa-spin text-4xl"></i></div></div>`;
            try {
                const snapshot = await getDocs(config.query);
                const currentLang = localStorage.getItem('calanit_lang') || 'he';
                if (snapshot.empty) { swiperWrapper.innerHTML = `<div class="swiper-slide bg-gray-200"><div class="story-overlay"></div><div class="story-content"><h3 class="text-3xl font-bold">${translations[currentLang][config.noJobsKey]}</h3></div></div>`; return; }
                swiperWrapper.innerHTML = '';
                snapshot.forEach(doc => {
                    const job = doc.data(), jobId = doc.id;
                    const imageUrl = job.imageUrl || `https://placehold.co/800x500/14b8a6/ffffff?text=${encodeURIComponent(job.title)}`;
                    const slide = document.createElement('div'); slide.className = 'swiper-slide'; slide.style.backgroundImage = `url('${imageUrl}')`;
                    slide.innerHTML = `<div class="story-overlay"></div><div class="story-content w-full"><h3 class="text-3xl md:text-4xl font-black drop-shadow-lg flex items-center gap-3"><i class="${config.jobIconClass}"></i> ${job.title || ''}</h3><div class="text-lg font-medium mt-2 mb-6 opacity-90"><i class="fas fa-map-marker-alt ml-1"></i> ${job.locations ? job.locations.join(', ') : ''}</div><a href="job-details.html?id=${jobId}" class="bg-white text-teal-600 px-8 py-3 rounded-full font-bold shadow-lg hover:bg-teal-50 transition text-lg mt-4 inline-block">${translations[currentLang]['details_button']}</a></div>`;
                    swiperWrapper.appendChild(slide);
                });
                new Swiper(`${config.containerId} .swiper`, { slidesPerView: 1, effect: 'fade', loop: snapshot.size > 1, autoplay: { delay: 7000 }, pagination: { el: `${config.containerId} .swiper-pagination`, type: 'progressbar' }, navigation: { nextEl: `${config.containerId} .swiper-button-next`, prevEl: `${config.containerId} .swiper-button-prev` } });
            } catch (error) { console.error(`Error loading jobs for ${config.containerId}:`, error); }
        }
        
        function setupCVModal() {
            const modal = document.getElementById('cv-modal'), form = document.getElementById('cv-form');
            document.getElementById('open-cv-modal-button').addEventListener('click', () => openCVModal());
            document.getElementById('close-cv-modal').addEventListener('click', () => closeModal());
            
            window.openCVModal = (jobId, jobTitle) => {
                window.currentJobIdForModal = jobId;
                window.currentJobTitleForModal = jobTitle;
                if(modal) {
                    modal.querySelector('#cv-modal-title').innerHTML = jobTitle
                        ? `${translations[localStorage.getItem('calanit_lang') || 'he']['cv_modal_title']} - ${jobTitle}`
                        : translations[localStorage.getItem('calanit_lang') || 'he']['cv_modal_title'];
                    modal.classList.remove('hidden');
                    setTimeout(() => {
                        modal.classList.remove('opacity-0');
                        modal.querySelector('.modal-content').classList.remove('scale-95', 'opacity-0');
                    }, 10);
                }
            };

            const closeModal = () => {
                if(modal) {
                    modal.classList.add('opacity-0');
                    modal.querySelector('.modal-content').classList.add('scale-95', 'opacity-0');
                    setTimeout(() => modal.classList.add('hidden'), 300);
                }
            };
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const submitBtn = form.querySelector('#cv-submit-button'), msgEl = form.querySelector('#cv-form-message');
                const lang = localStorage.getItem('calanit_lang') || 'he';
                submitBtn.disabled = true;
                submitBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${translations[lang].sending_message}`;
                const cvFile = form.querySelector('#cvFile').files[0];
                if (!cvFile) {
                    msgEl.className = 'text-red-600 font-semibold';
                    msgEl.textContent = '×—×•×‘×” ×œ×”×¢×œ×•×ª ×§×•×‘×¥.';
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = `<span>${translations[lang].cta_button}</span>`;
                    return;
                }
                const storageRef = ref(storage, `cvs/${Date.now()}_${cvFile.name}`);
                try {
                    await uploadBytes(storageRef, cvFile);
                    const fileURL = await getDownloadURL(storageRef);
                    await addDoc(collection(db, "jobApplicants"), {
                        firstName: form.querySelector('#firstName').value,
                        lastName: form.querySelector('#lastName').value,
                        phone: form.querySelector('#phone').value,
                        fileURL,
                        jobId: window.currentJobIdForModal || null,
                        jobTitle: window.currentJobTitleForModal || '×”×’×©×” ×›×œ×œ×™×ª',
                        createdAt: serverTimestamp()
                    });
                    msgEl.className = 'text-green-600 font-semibold';
                    msgEl.textContent = translations[lang].success_message;
                    form.reset();
                    setTimeout(closeModal, 2000);
                } catch (err) {
                    msgEl.className = 'text-red-600 font-semibold';
                    msgEl.textContent = translations[lang].error_message;
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = `<span>${translations[lang].cta_button}</span>`;
                }
            });
        }

        document.addEventListener('DOMContentLoaded', async () => {
            loadComponent('menu.html', 'header-placeholder', () => {
                document.getElementById('mobile-menu-button')?.addEventListener('click', () => document.getElementById('mobile-menu')?.classList.toggle('hidden'));
                document.querySelectorAll('.lang-btn-menu').forEach(btn => btn.addEventListener('click', () => setLanguage(btn.id.includes('-ar-') ? 'ar' : 'he')));
                setLanguage(localStorage.getItem('calanit_lang') || 'he');
                renderPartnersMarquee();
            });
            loadComponent('footer.html', 'footer-placeholder', () => { setLanguage(localStorage.getItem('calanit_lang') || 'he'); });
            
            [allCities, jobTypesData] = await Promise.all([ loadJsonData('cities.json', []), loadJsonData('jobTypesHierarchical.json', {}) ]);
            
            setupFilterBubbles({ input: document.getElementById('location-search-input'), resultsContainer: document.getElementById('autocomplete-results'), bubblesContainer: document.getElementById('selected-locations-container'), dataSet: allCities, selectedSet: selectedLocations, colorClass: 'bubble-location' });
            setupCategoryFilter();
            
            const categoriesContainer = document.getElementById('selected-categories-container');
            categoriesContainer.addEventListener('render', () => {
                categoriesContainer.innerHTML = '';
                selectedCategories.forEach(item => { const bubble = document.createElement('div'); bubble.className = `bubble-category text-sm font-semibold px-3 py-1.5 rounded-full flex items-center gap-2`; bubble.innerHTML = `<span>${item}</span><button type="button" class="font-sans text-sm opacity-75 hover:opacity-100">&times;</button>`; bubble.querySelector('button').addEventListener('click', () => { selectedCategories.delete(item); categoriesContainer.dispatchEvent(new Event('render')); }); categoriesContainer.appendChild(bubble); });
            });
            
            document.getElementById('search-button').addEventListener('click', () => {
                const params = new URLSearchParams();
                const keyword = document.getElementById('keyword-search-input').value;
                if(keyword) params.append('keyword', keyword);
                if(selectedLocations.size > 0) params.append('locations', Array.from(selectedLocations).join(','));
                if(selectedCategories.size > 0) params.append('categories', Array.from(selectedCategories).join(','));
                window.location.href = `jobs.html?${params.toString()}`;
            });

            document.querySelectorAll('.animated-section').forEach(el => new IntersectionObserver((entries) => { if(entries[0].isIntersecting) el.classList.add('is-visible'); }, {threshold: 0.1}).observe(el));
            
            setupCVModal();
            setLanguage(localStorage.getItem('calanit_lang') || 'he');
        });
        
        async function renderPartnersMarquee() {
    const marquee = document.getElementById('partners-marquee-track');
    marquee.innerHTML = '<span style="font-size:1.2em;color:#38bdf8;">×˜×•×¢×Ÿ...</span>';
    try {
        const snapshot = await getDocs(collection(db, "partners"));
        let partners = [];
        snapshot.forEach(doc => {
            const data = doc.data();
            if (data.logoUrl) {
                partners.push({ name: data.name, logoUrl: data.logoUrl });
            }
        });
        if (partners.length === 0) {
            marquee.innerHTML = `<span style="font-size:1.2em;color:#38bdf8;">×¢×“×™×™×Ÿ ×œ× ×”×•×’×“×¨×• ×œ×•×’×•××™× ×©×œ ×—×‘×¨×•×ª...</span>`;
            return;
        }
        // ×”×›×¤×œ×ª ×”×¨×©×™××” ×›×“×™ ×©×”××¨×§×™×– ×™×”×™×” ××™× ×¡×•×¤×™
        const doublePartners = partners.concat(partners);
        marquee.innerHTML = '';
        doublePartners.forEach(p =>
            marquee.innerHTML += `
                <div class="partner-logo-wrapper" title="${p.name}">
                    <img class="partner-logo-img" src="${p.logoUrl}" alt="${p.name}">
                </div>
            `
        );
    } catch (e) {
        marquee.innerHTML = `<span style="font-size:1.2em;color:#f87171;">×©×’×™××” ×‘×˜×¢×™× ×ª ×”×—×‘×¨×•×ª</span>`;
    }
}
        
    </script>
</body>
</html>
